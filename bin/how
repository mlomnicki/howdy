#!/usr/bin/env ruby

require 'rubygems'
require 'optparse'
require File.join(File.dirname(__FILE__), '..', 'lib', 'howdy')

opts = OptionParser.new do |opts|

  opts.banner = "Usage: #{File.basename($0)} [-c|--choose [DICTIONARY]] [-l|--list] [-h|--help] WORDS"

  opts.on("-c", "--choose DICTIONARY", "Interactively choose dictionary or directly pass one (-l switch to list)") do |c|
    if dict_klass = Howdy::Dictionary.find_by_label(c)
      Howdy::Dictionary.set(dict_klass)
    else
      puts "Dictionary: '#{c}' not found. Choose one of available dictionaries"
      exit 1
    end
  end

  opts.on("-l", "--list", "List available dictionaries") do |l|
    Howdy::Dictionary.available.each do |dict|
      puts "  #{dict.dict_label} - #{dict.dict_description}"
    end
    exit
  end

  opts.on_tail("-h", "--help", "Show this message") do |h|
    puts opts
    exit
  end

end
opts.parse!

if ARGV.empty?
  puts opts
  exit
end

dict = Howdy::Dictionary.current.new(ARGV.join(' '))
dict.parse
dict.print

